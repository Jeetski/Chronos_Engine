Chronos Collaboration / Shared Localhost Concept
===============================================

Scope: peer-to-peer Chronos linking over virtual LAN tools (Hamachi, Tailscale, ZeroTier) without deploying a hosted server. Partners expose their dashboard/CLI on tunnel IPs, approve each request locally, and gain lightweight co-pilot features.

------------------------------------------------------------
1. Discovery & Handshake
------------------------------------------------------------
- `User/Profile/collab.yml` to publish nickname, timezone, tunnel address, and allowed scopes (read-only dashboards, challenge exchange, CLI verbs, etc.).
- “Collab Connect” widget/panel gathers the peer’s tunnel URL, fetches `/health` + `/api/profile`, and saves contacts.
- Optional pre-shared token (toggle switch in dashboard) gates inbound calls; unapproved requests appear in an approval queue inside the dashboard.

------------------------------------------------------------
2. Security Envelope
------------------------------------------------------------
- Every inbound call is logged; sensitive actions (editing, new reminder) show a toast “Allow Alex to … ? Always allow from this peer?”.
- Allowlist CLI verbs when exposing `/api/cli` to peers; default to read-only views unless the user explicitly unlocks edits.
- Big “Pause Collaboration” switch to stop remote calls while offline or in focus mode.
- Activity feed/audit log for all collab traffic.

------------------------------------------------------------
3. Shared Views, Widgets & Panels (“VS mode”)
------------------------------------------------------------
- **Co-Pilot view**: side-by-side Today timelines and status strips.
- **Peer Progress widget**: shows streaks, energy/mood, current block.
- **Challenge Board panel**: accepted/pending/completed challenges with quick approve/decline buttons.
- **Race Panel**: live leaderboard for metrics (minutes focused today, habits streaks, points).
- **Shared timeline overlay**: see partner’s availability inside your Cockpit.
- **Buddy timer**: start a focus timer that invites the peer; both instances start the same profile on acceptance.
- All widgets/panels fetch the peer’s data directly via their exposed `/api/*` endpoints.

------------------------------------------------------------
4. Challenges & Templates
------------------------------------------------------------
- Challenge schema stored under `User/Collab/challenges/<id>.yml`: issuer, target, template reference, win conditions, optional reward/punishment hooks.
- Templates can be single items or nested routines/projects. Examples: “500 push-ups”, “Publish daily journal 7 days in a row”.
- Conditions reuse Chronos’ condition engine (streak, count, status thresholds).
- Completion proof = local Chronos emits signed snapshot (hash + timestamp) to peers for verification.
- Modes: cooperative (all must finish), competitive (first wins), mentor (coach issues a challenge and monitors progress).

------------------------------------------------------------
5. Messaging & Presence
------------------------------------------------------------
- **DM channel** stored locally (`User/Collab/messages.yml`) with +name mentions (avoid @ to protect Chronos vars). Quick slash commands: `/challenge`, `/cheer`, `/nudge`.
- “Nudge” action triggers a toast or optional reminder on the peer (e.g., “Hydrate break”), subject to approval.
- Presence heartbeat: optional JSON ping every few minutes with current block/availability so collaborators know when to reach out.

------------------------------------------------------------
6. Shared Leaderboards & Pools
------------------------------------------------------------
- Category/Tag leaderboards (minutes completed, streak length, points) for the group.
- Item-specific races (who performs routine XYZ fastest/most often).
- “Energy Debt” board comparing how often each pilot trims/reschedules.
- Community backlog: shared pool of optional tasks/projects; claiming one copies it to your workspace and flags you as owner.

------------------------------------------------------------
7. Shared Projects & Assignments
------------------------------------------------------------
- Projects gain `collaborators:` metadata with peer IDs + permissions.
- Tasks/routines accept `owner:` or `owners:` fields referencing collaborators.
- Delta-based sync: source Chronos publishes JSON diffs (new task, status change), peers approve and merge locally.
- Role-aware templates: map roles to real collaborators when instantiating a project so assignments auto-populate.
- Shared OKRs/goals with combined progress bars and per-person contributions.

------------------------------------------------------------
8. Reviews & Joint Sessions
------------------------------------------------------------
- Collaborative review view where each pilot drops weekly highlights/lessons; Chronos can export a combined recap PDF.
- Virtual standup command: pings peers, surfaces top blockers, offers to sync timers.
- Cross-instance variables (subset) broadcast to show mood/focus/availability.

------------------------------------------------------------
9. Implementation Notes
------------------------------------------------------------
- Transport: reuse existing dashboard server; peers hit `/api/collab/*` endpoints via tunnel IP.
- All inbound requests map to existing modules (ItemManager, CLI) but are wrapped with permission checks and logging.
- DMs/challenges/leaderboard data live under `User/Collab/` so they’re version-controlled alongside personal data.
- Mention syntax: `+name` to avoid collisions with `@vars`.

Use this document as the backlog when we’re ready to implement collab features. Finest-grain stories can be cut from each section (e.g., “Collab Connect widget”, “Challenge schema”, “Shared Today overlay”, “Direct messaging with +mentions”). 
